<!DOCTYPE html>
<html>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>potrace</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/styles/github.min.css">
<style>
    body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
    }

    pre code {
        font-size: 12px;
        font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
    }
</style>
<h1>potrace demo</h1>

<div data-func="example1">
    <h2>Example 1: Open URL and write SVG</h2>
    <pre><code class="javascript"></code></pre>
    <input type="button" value="Run">
    <script>
        function example1(callback) {
            var img = new Image(),
                scale = 1;
            img.crossOrigin = 'anonymous';
            img.src = 'https://www.gravatar.com/avatar/ea4d591101f572e45312cf75901032b4?s=256';
            img.onload = function() {
                var div = document.createElement('div');
                // Hint: You can also use a canvas as an image.
                div.innerHTML = potrace.fromImage(img).toSVG(scale);
                callback(div);
            }
        }
    </script>
    <div></div>
</div>

<div data-func="example2">
    <h2>Example 2: Open custom data and stroke to the Canvas</h2>
    <pre><code class="javascript"></code></pre>
    <input type="button" value="Run">
    <script>
        function example2(callback) {
            function getPixel(x, y) {
                return x % 50 > 25 != y % 50 < 25;
            }

            var canvas = document.createElement('canvas');
            canvas.width = 200;
            canvas.height = 200;

            var ctx = canvas.getContext('2d');
            ctx.beginPath();
            potrace.fromFunction(getPixel, canvas.width, canvas.height).strokePath(ctx);
            ctx.fill(); // or ctx.stroke();
            callback(canvas);
        }
    </script>
    <div></div>
</div>

<div data-func="example3">
    <h2>Example 3: Open URL and get Paths</h2>
    <pre><code class="javascript"></code></pre>
    <input type="button" value="Run">
    <script>
        function example3(callback) {
            var img = new Image();
            img.crossOrigin = 'anonymous';
            img.src = 'https://www.gravatar.com/avatar/ea4d591101f572e45312cf75901032b4?s=256';
            img.onload = function() {
                var o = potrace.fromImage(img).simplify();

                var canvas = document.createElement('canvas');
                canvas.width = o.width;
                canvas.height = o.height;

                var ctx = canvas.getContext('2d');
                ctx.beginPath();
                for (var i = 0; i < o.paths.length; ++i) {
                    var p = o.paths[i];
                    switch (p.length) {
                        case 2:
                            ctx.moveTo(p[0], p[1]);
                            break;
                        case 4:
                            ctx.lineTo(p[0], p[1]);
                            ctx.lineTo(p[2], p[3]);
                            break;
                        case 6:
                            ctx.bezierCurveTo(p[0], p[1], p[2], p[3], p[4], p[5]);
                            break;
                    }
                }
                ctx.closePath();
                ctx.fill();
                callback(canvas);
            }
        }
    </script>
    <div></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/highlight.min.js"></script>
<script src="potrace.js"></script>
<script>
    var img = new Image();
    img.crossOrigin = 'anonymous';
    img.src = 'https://www.gravatar.com/avatar/ea4d591101f572e45312cf75901032b4?s=256';

    function demo(elem) {
        elem.querySelector('input').addEventListener('click', function(e) {
            var result = elem.querySelector('div');
            result.innerHTML = 'processing...';
            window[elem.getAttribute('data-func')](function(elem) {
                result.innerHTML = '';
                result.appendChild(elem);
            });
        }, false);
        elem.querySelector('code').appendChild(
            document.createTextNode(elem.querySelector('script').innerHTML)
        );
    }

    window.addEventListener('DOMContentLoaded', function() {
        var elems = document.querySelectorAll('div[data-func]');
        for (var i = 0; i < elems.length; ++i) {
            demo(elems[i]);
        }
        hljs.initHighlightingOnLoad();
    }, false);
</script>

</html>
